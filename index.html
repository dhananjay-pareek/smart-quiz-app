<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn-It-All Quiz App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="quiz-logo.gif" rel="icon" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: none;
        }
        .btn-primary {
            background-color: #4f46e5;
            color: white;
        }
        .btn-primary:hover {
            background-color: #4338ca;
        }
        .btn-secondary {
            background-color: #e5e7eb;
            color: #1f2937;
        }
         .btn-secondary:hover {
            background-color: #d1d5db;
        }
        .option-btn {
            width: 100%;
            text-align: left;
            background-color: #f9fafb;
            color: #1f2937;
            border: 1px solid #d1d5db;
        }
        .option-btn:hover {
            background-color: #f3f4f6;
        }
        .option-btn.correct {
            background-color: #dcfce7;
            border-color: #22c55e;
            color: #166534;
        }
        .option-btn.incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
            color: #991b1b;
        }
        .hidden {
            display: none;
        }
         #congrats-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 9999;
    background: black;
  }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
            <audio id="bg-music" loop>
  <source src="bg-music.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
<img id="congrats-gif" src="congrats.gif" alt="Congratulations!" class="hidden" style="position:fixed;top:0;left:0;width:100vw;height:100vh;object-fit:cover;z-index:9999;pointer-events:none;" />


    <div id="app" class="max-w-2xl w-full">
        <!-- Main Menu View -->
        <div id="main-menu" class="card text-center">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Learn-It-All Quiz</h1>
            <p class="text-gray-600 mb-8">Master any subject with smart quizzes.</p>
            <div class="flex flex-col sm:flex-column gap-4 justify-center">
                <button id="start-quiz-btn" class="btn btn-primary">Start Quiz</button>
                <button id="manage-questions-btn" class="btn btn-secondary">Manage Questions</button>
            </div>
        </div>

        <!-- Quiz View -->
        <div id="quiz-view" class="card hidden">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <button id="home-btn" class="text-sm font-semibold text-gray-600 hover:text-indigo-600 transition-colors">‚Üê Home</button>
                    <div class="flex items-center gap-4">
                        <p class="text-sm font-medium text-gray-500">Question <span id="question-count"></span></p>
                        <p class="text-sm font-medium text-indigo-600">Score: <span id="score-count">0</span></p>
                    </div>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-indigo-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <h2 id="question-text" class="text-2xl font-semibold text-gray-800 mb-6"></h2>
            <div id="options-container" class="space-y-4"></div>
            <p id="feedback-text" class="mt-6 text-center font-semibold text-lg"></p>
        </div>
        
        <!-- Quiz Complete View -->
        <div id="quiz-complete-view" class="card text-center hidden">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Congratulations!</h1>
            <p class="text-gray-600 mb-4">You've successfully completed the quiz. Great job!</p>
            <p class="text-3xl font-bold text-indigo-600 mb-8">Final Score: <span id="final-score"></span></p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="play-again-btn" class="btn btn-primary">Play Again</button>
                <button id="back-to-menu-btn" class="btn btn-secondary">Main Menu</button>
            </div>
        </div>

        <!-- Manage Questions View -->
        <div id="manage-questions-view" class="card hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-gray-800">Custom Questions</h2>
                <div class="flex gap-2">
                    <button id="add-new-question-btn" class="btn btn-primary text-sm sm:text-base">Add New</button>
                    <button id="bulk-add-btn" class="btn btn-secondary text-sm sm:text-base">Bulk Add</button>
                </div>
            </div>
            
            <div id="custom-questions-list" class="space-y-3 mb-6">
                 <!-- Custom questions will be listed here -->
            </div>

            <form id="add-question-form" class="p-6 bg-gray-50 rounded-lg border hidden">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">New Question</h3>
                <p id="add-form-feedback" class="text-sm text-red-600 min-h-[1.25rem] mb-4"></p>
                
                <div class="mb-4">
                    <label for="question-type" class="block text-sm font-medium text-gray-700 mb-1">Question Type</label>
                    <select id="question-type" class="w-full p-2 border border-gray-300 rounded-md">
                        <option value="mcq">Multiple Choice</option>
                        <option value="tf">True / False</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="new-question-text" class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                    <textarea id="new-question-text" rows="3" class="w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., What is the capital of Japan?"></textarea>
                </div>

                <div id="mcq-options" class="mb-4 space-y-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Options</label>
                    <input type="text" placeholder="Option 1" class="w-full p-2 border border-gray-300 rounded-md mcq-option-input">
                    <input type="text" placeholder="Option 2" class="w-full p-2 border border-gray-300 rounded-md mcq-option-input">
                    <input type="text" placeholder="Option 3" class="w-full p-2 border border-gray-300 rounded-md mcq-option-input">
                    <input type="text" placeholder="Option 4" class="w-full p-2 border border-gray-300 rounded-md mcq-option-input">
                </div>

                <div class="mb-6">
                     <label for="correct-answer" class="block text-sm font-medium text-gray-700 mb-1">Correct Answer</label>
                     <select id="correct-answer" class="w-full p-2 border border-gray-300 rounded-md">
                         <!-- Options will be populated by JS -->
                     </select>
                </div>

                <div class="flex gap-4">
                    <button type="submit" class="btn btn-primary flex-1">Save Question</button>
                    <button type="button" id="cancel-add-question-btn" class="btn btn-secondary flex-1">Cancel</button>
                </div>
            </form>
            
            <div class="mt-6 text-center">
                <button id="back-to-menu-from-manage-btn" class="btn btn-secondary">Back to Main Menu</button>
            </div>
        </div>

        <!-- Bulk Add Questions View -->
        <div id="bulk-add-view" class="card hidden">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Bulk Add Questions</h2>
            <p class="text-gray-600 mb-4">Paste your questions in JSON format below. Ensure the structure matches the example provided.</p>
            
            <div class="bg-gray-100 p-3 rounded-lg mb-4 text-xs text-gray-700 overflow-auto">
                <pre><code>[
  {
    "type": "mcq",
    "text": "Your question here?",
    "options": ["Option 1", "Option 2", "Option 3", "Option 4"],
    "answer": 0
  },
  {
    "type": "tf",
    "text": "Is this statement true?",
    "options": ["True", "False"],
    "answer": 1
  }
]</code></pre>
            </div>

            <textarea id="bulk-json-input" class="w-full p-2 border border-gray-300 rounded-md h-48 font-mono text-sm" placeholder="Paste your JSON array here..."></textarea>
            <p id="bulk-feedback" class="text-sm mt-2 min-h-[1.25rem]"></p>

            <div class="flex gap-4 mt-4">
                <button id="save-bulk-btn" class="btn btn-primary flex-1">Save Questions</button>
                <button id="cancel-bulk-btn" class="btn btn-secondary flex-1">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 shadow-xl w-full max-w-sm">
            <h3 id="modal-title" class="text-lg font-medium text-gray-900 mb-4">Confirmation</h3>
            <p id="modal-body" class="text-sm text-gray-600 mb-6"></p>
            <div class="flex justify-end gap-4">
                <button id="modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                <button id="modal-confirm-btn" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script>
        const App = {
            // STATE
            state: {
                currentView: 'main-menu',
                allQuestions: [],
                quizQueue: [],
                currentQuestionIndex: 0,
                score: 0,
                totalInitialQuestions: 0,
            },

            // UI ELEMENTS
            elements: {
                mainMenu: document.getElementById('main-menu'),
                quizView: document.getElementById('quiz-view'),
                quizCompleteView: document.getElementById('quiz-complete-view'),
                manageQuestionsView: document.getElementById('manage-questions-view'),
                bulkAddView: document.getElementById('bulk-add-view'),
                
                // Buttons
                startQuizBtn: document.getElementById('start-quiz-btn'),
                manageQuestionsBtn: document.getElementById('manage-questions-btn'),
                playAgainBtn: document.getElementById('play-again-btn'),
                backToMenuBtn: document.getElementById('back-to-menu-btn'),
                homeBtn: document.getElementById('home-btn'),
                backToMenuFromManageBtn: document.getElementById('back-to-menu-from-manage-btn'),
                addNewQuestionBtn: document.getElementById('add-new-question-btn'),
                cancelAddQuestionBtn: document.getElementById('cancel-add-question-btn'),
                bulkAddBtn: document.getElementById('bulk-add-btn'),
                saveBulkBtn: document.getElementById('save-bulk-btn'),
                cancelBulkBtn: document.getElementById('cancel-bulk-btn'),
                
                // Quiz UI
                questionCount: document.getElementById('question-count'),
                scoreCount: document.getElementById('score-count'),
                progressBar: document.getElementById('progress-bar'),
                questionText: document.getElementById('question-text'),
                optionsContainer: document.getElementById('options-container'),
                feedbackText: document.getElementById('feedback-text'),
                
                // Complete View UI
                finalScore: document.getElementById('final-score'),

                // Manage Questions UI
                addQuestionForm: document.getElementById('add-question-form'),
                addFormFeedback: document.getElementById('add-form-feedback'),
                questionTypeSelect: document.getElementById('question-type'),
                newQuestionText: document.getElementById('new-question-text'),
                mcqOptionsContainer: document.getElementById('mcq-options'),
                mcqOptionInputs: document.querySelectorAll('.mcq-option-input'),
                correctAnswerSelect: document.getElementById('correct-answer'),
                customQuestionsList: document.getElementById('custom-questions-list'),
                bulkJsonInput: document.getElementById('bulk-json-input'),
                bulkFeedback: document.getElementById('bulk-feedback'),

                // Modal UI
                confirmModal: document.getElementById('confirm-modal'),
                modalTitle: document.getElementById('modal-title'),
                modalBody: document.getElementById('modal-body'),
                modalConfirmBtn: document.getElementById('modal-confirm-btn'),
                modalCancelBtn: document.getElementById('modal-cancel-btn'),
            },

            // INITIALIZATION
            init() {
                this.loadQuestions();
                this.bindEvents();
                this.render();
            },

            // EVENT BINDING
            bindEvents() {
                this.elements.startQuizBtn.addEventListener('click', () => this.startQuiz());
                this.elements.manageQuestionsBtn.addEventListener('click', () => this.switchView('manage-questions-view'));
                this.elements.playAgainBtn.addEventListener('click', () => this.startQuiz());
                this.elements.backToMenuBtn.addEventListener('click', () => this.switchView('main-menu'));
                this.elements.homeBtn.addEventListener('click', () => {
                    this.showConfirmModal(
                        "Are you sure you want to end the quiz and return home? Your progress will be lost.",
                        () => this.switchView('main-menu')
                    );
                });
                this.elements.backToMenuFromManageBtn.addEventListener('click', () => this.switchView('main-menu'));
                this.elements.addNewQuestionBtn.addEventListener('click', () => this.showAddQuestionForm());
                this.elements.cancelAddQuestionBtn.addEventListener('click', () => this.hideAddQuestionForm());
                this.elements.questionTypeSelect.addEventListener('change', () => this.updateFormForQuestionType());
                this.elements.addQuestionForm.addEventListener('submit', (e) => this.saveQuestion(e));
                this.elements.bulkAddBtn.addEventListener('click', () => this.showBulkAddView());
                this.elements.cancelBulkBtn.addEventListener('click', () => this.switchView('manage-questions-view'));
                this.elements.saveBulkBtn.addEventListener('click', () => this.saveBulkQuestions());
                this.elements.modalCancelBtn.addEventListener('click', () => this.hideConfirmModal());
                
                // Dynamically update correct answer options when MCQ options are typed
                this.elements.mcqOptionInputs.forEach((input, index) => {
                    input.addEventListener('input', () => this.updateCorrectAnswerOptions());
                });
            },
            
            // VIEW MANAGEMENT
            switchView(viewName) {
                this.state.currentView = viewName;
                this.render();
            },
            
            render() {
                ['mainMenu', 'quizView', 'quizCompleteView', 'manageQuestionsView', 'bulkAddView'].forEach(viewKey => {
                    this.elements[viewKey].classList.add('hidden');
                });
                
                const viewMap = {
                    'main-menu': 'mainMenu',
                    'quiz-view': 'quizView',
                    'quiz-complete-view': 'quizCompleteView',
                    'manage-questions-view': 'manageQuestionsView',
                    'bulk-add-view': 'bulkAddView'
                };
                const currentViewElement = this.elements[viewMap[this.state.currentView]];
                if (currentViewElement) {
                    currentViewElement.classList.remove('hidden');
                }

                if (this.state.currentView === 'manage-questions-view') {
                    this.renderCustomQuestionsList();
                }
            },

            // QUIZ LOGIC
            startQuiz() {
                if (this.state.allQuestions.length === 0) {
                    this.showConfirmModal(
                        "No questions available! Please add some first. Go to the question manager?",
                        () => this.switchView('manage-questions-view')
                    );
                    return;
                }
                // Reset state
                this.state.score = 0;
                this.state.currentQuestionIndex = 0;
                // Deep copy and shuffle questions
                this.state.quizQueue = JSON.parse(JSON.stringify(this.state.allQuestions))
                                            .sort(() => Math.random() - 0.5);
                this.state.totalInitialQuestions = this.state.quizQueue.length;
                this.switchView('quiz-view');
                this.displayCurrentQuestion();
            },

            displayCurrentQuestion() {
                this.elements.feedbackText.textContent = '';
                if (this.state.currentQuestionIndex >= this.state.quizQueue.length) {
                    this.completeQuiz();
                    return;
                }

                const question = this.state.quizQueue[this.state.currentQuestionIndex];
                
                // Update UI
                this.elements.questionText.textContent = question.text;
                this.elements.scoreCount.textContent = this.state.score;
                this.elements.questionCount.textContent = `${this.state.currentQuestionIndex + 1} / ${this.state.quizQueue.length}`;
                
                const progress = this.state.totalInitialQuestions > 0 
                    ? Math.min(100, (this.state.score / this.state.totalInitialQuestions) * 100)
                    : 0;
                this.elements.progressBar.style.width = `${progress}%`;

                this.elements.optionsContainer.innerHTML = '';
                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'btn option-btn';
                    button.addEventListener('click', () => this.handleAnswer(index, button));
                    this.elements.optionsContainer.appendChild(button);
                });
            },

            handleAnswer(selectedIndex, selectedButton) {
                const question = this.state.quizQueue[this.state.currentQuestionIndex];
                const isCorrect = selectedIndex === question.answer;

                // Disable all buttons after an answer is selected
                this.elements.optionsContainer.querySelectorAll('button').forEach(btn => btn.disabled = true);

                if (isCorrect) {
                    this.state.score++;
                    // --- FIX START: Instantly update score and progress bar on correct answer ---
                    this.elements.scoreCount.textContent = this.state.score;
                    const progress = this.state.totalInitialQuestions > 0 
                        ? Math.min(100, (this.state.score / this.state.totalInitialQuestions) * 100)
                        : 0;
                    this.elements.progressBar.style.width = `${progress}%`;
                    // --- FIX END ---
                    selectedButton.classList.add('correct');
                    this.elements.feedbackText.textContent = 'Correct!';
                    this.elements.feedbackText.className = 'mt-6 text-center font-semibold text-lg text-green-600';
                    
                    setTimeout(() => {
                        this.state.currentQuestionIndex++;
                        this.displayCurrentQuestion();
                    }, 1200);

                } else {
                    selectedButton.classList.add('incorrect');
                    this.elements.optionsContainer.children[question.answer].classList.add('correct');
                    this.elements.feedbackText.textContent = 'Incorrect. Let\'s try this one again later.';
                    this.elements.feedbackText.className = 'mt-6 text-center font-semibold text-lg text-red-600';
                    
                    // Spaced Repetition: Move incorrect question to later in the queue
                    const incorrectQuestion = this.state.quizQueue.splice(this.state.currentQuestionIndex, 1)[0];
                    const reinsertIndex = Math.min(this.state.quizQueue.length, this.state.currentQuestionIndex + 3);
                    this.state.quizQueue.splice(reinsertIndex, 0, incorrectQuestion);

                    setTimeout(() => {
                        // Do not increment currentQuestionIndex, as the array has shifted
                        this.displayCurrentQuestion();
                    }, 2000);
                }
            },

        completeQuiz() {
    // Show the congrats GIF fullscreen
    const congratsGif = document.getElementById('congrats-gif');
    if (congratsGif) {
        congratsGif.classList.remove('hidden');
    }
    this.elements.finalScore.textContent = `${this.state.score} / ${this.state.totalInitialQuestions}`;
    this.switchView('quiz-complete-view');
},


            // QUESTION MANAGEMENT
            loadQuestions() {
                const defaultQuestions = [
                    { type: 'mcq', text: 'What is the capital of France?', options: ['Berlin', 'Madrid', 'Paris', 'Rome'], answer: 2 },
                    { type: 'tf', text: 'The Great Wall of China is visible from space with the naked eye.', options: ['True', 'False'], answer: 1 },
                    { type: 'mcq', text: 'Which planet is known as the Red Planet?', options: ['Earth', 'Mars', 'Jupiter', 'Venus'], answer: 1 },
                    { type: 'mcq', text: 'What is the largest ocean on Earth?', options: ['Atlantic', 'Indian', 'Arctic', 'Pacific'], answer: 3 },
                ];
                const customQuestions = JSON.parse(localStorage.getItem('customQuizQuestions')) || [];
                this.state.allQuestions = [...defaultQuestions, ...customQuestions];
            },
            
            saveQuestion(event) {
                event.preventDefault();
                this.elements.addFormFeedback.textContent = ''; // Clear feedback
                const type = this.elements.questionTypeSelect.value;
                const text = this.elements.newQuestionText.value.trim();
                const correctAnswerIndex = parseInt(this.elements.correctAnswerSelect.value);

                if (!text) {
                    this.elements.addFormFeedback.textContent = 'Please enter the question text.';
                    return;
                }

                let options = [];
                if (type === 'mcq') {
                    options = Array.from(this.elements.mcqOptionInputs).map(input => input.value.trim());
                    if (options.some(opt => opt === '')) {
                        this.elements.addFormFeedback.textContent = 'Please fill out all four options.';
                        return;
                    }
                } else {
                    options = ['True', 'False'];
                }

                const newQuestion = {
                    type,
                    text,
                    options,
                    answer: correctAnswerIndex,
                    isCustom: true
                };

                const customQuestions = JSON.parse(localStorage.getItem('customQuizQuestions')) || [];
                customQuestions.push(newQuestion);
                localStorage.setItem('customQuizQuestions', JSON.stringify(customQuestions));
                
                this.loadQuestions(); // Reload all questions
                this.renderCustomQuestionsList();
                this.hideAddQuestionForm();
            },

            saveBulkQuestions() {
                const jsonString = this.elements.bulkJsonInput.value.trim();
                this.elements.bulkFeedback.textContent = ''; // Clear previous feedback

                if (!jsonString) {
                    this.elements.bulkFeedback.textContent = 'Input cannot be empty.';
                    this.elements.bulkFeedback.className = 'text-sm mt-2 text-red-600 min-h-[1.25rem]';
                    return;
                }

                try {
                    const questions = JSON.parse(jsonString);

                    if (!Array.isArray(questions)) {
                        throw new Error('The provided data is not a valid JSON array.');
                    }

                    // Validate each question object
                    for (const q of questions) {
                        if (typeof q.text !== 'string' || !q.text) throw new Error('An item has an invalid or missing "text" property.');
                        if (q.type !== 'mcq' && q.type !== 'tf') throw new Error('An item has an invalid "type". Must be "mcq" or "tf".');
                        if (!Array.isArray(q.options) || q.options.length === 0) throw new Error('An item has an invalid or missing "options" array.');
                        if (typeof q.answer !== 'number' || q.answer < 0 || q.answer >= q.options.length) throw new Error('An item has an invalid "answer" index.');
                    }

                    // If validation passes
                    const existingCustomQuestions = JSON.parse(localStorage.getItem('customQuizQuestions')) || [];
                    const newCustomQuestions = questions.map(q => ({ ...q, isCustom: true }));
                    const allCustomQuestions = [...existingCustomQuestions, ...newCustomQuestions];

                    localStorage.setItem('customQuizQuestions', JSON.stringify(allCustomQuestions));
                    this.loadQuestions(); // Reload all questions into the app state
                    
                    this.switchView('manage-questions-view');

                } catch (error) {
                    this.elements.bulkFeedback.textContent = `Error: ${error.message}`;
                    this.elements.bulkFeedback.className = 'text-sm mt-2 text-red-600 min-h-[1.25rem]';
                }
            },

            deleteQuestion(indexToDelete) {
                let customQuestions = JSON.parse(localStorage.getItem('customQuizQuestions')) || [];
                customQuestions.splice(indexToDelete, 1);
                localStorage.setItem('customQuizQuestions', JSON.stringify(customQuestions));
                this.loadQuestions();
                this.renderCustomQuestionsList();
            },

            renderCustomQuestionsList() {
                this.elements.customQuestionsList.innerHTML = '';
                const customQuestions = this.state.allQuestions.filter(q => q.isCustom);
                
                if (customQuestions.length === 0) {
                    this.elements.customQuestionsList.innerHTML = `<p class="text-gray-500 text-center bg-gray-50 p-4 rounded-md">You haven't added any custom questions yet.</p>`;
                    return;
                }

                customQuestions.forEach((question, index) => {
                    const div = document.createElement('div');
                    div.className = 'flex justify-between items-center p-3 bg-white border rounded-lg';
                    div.innerHTML = `
                        <p class="text-gray-700 flex-1 mr-4">${question.text.substring(0, 50)}${question.text.length > 50 ? '...' : ''}</p>
                        <button class="text-red-500 hover:text-red-700 font-semibold" data-index="${index}">Delete</button>
                    `;
                    div.querySelector('button').addEventListener('click', (e) => this.deleteQuestion(parseInt(e.target.dataset.index)));
                    this.elements.customQuestionsList.appendChild(div);
                });
            },

            showAddQuestionForm() {
                this.elements.addQuestionForm.classList.remove('hidden');
                this.elements.addNewQuestionBtn.classList.add('hidden');
                this.elements.addQuestionForm.reset();
                this.elements.addFormFeedback.textContent = '';
                this.updateFormForQuestionType();
            },

            hideAddQuestionForm() {
                this.elements.addQuestionForm.classList.add('hidden');
                this.elements.addNewQuestionBtn.classList.remove('hidden');
            },

            showBulkAddView() {
                this.elements.bulkJsonInput.value = '';
                this.elements.bulkFeedback.textContent = '';
                this.switchView('bulk-add-view');
            },

            showConfirmModal(message, onConfirmCallback) {
                this.elements.modalBody.textContent = message;
                this.elements.confirmModal.classList.remove('hidden');
                
                // Clone and replace the confirm button to remove old event listeners
                const newConfirmBtn = this.elements.modalConfirmBtn.cloneNode(true);
                this.elements.modalConfirmBtn.parentNode.replaceChild(newConfirmBtn, this.elements.modalConfirmBtn);
                this.elements.modalConfirmBtn = newConfirmBtn;
                
                this.elements.modalConfirmBtn.onclick = () => {
                    this.hideConfirmModal();
                    onConfirmCallback();
                };
            },

            hideConfirmModal() {
                this.elements.confirmModal.classList.add('hidden');
            },

            updateFormForQuestionType() {
                const type = this.elements.questionTypeSelect.value;
                if (type === 'mcq') {
                    this.elements.mcqOptionsContainer.classList.remove('hidden');
                    this.updateCorrectAnswerOptions();
                } else { // True/False
                    this.elements.mcqOptionsContainer.classList.add('hidden');
                    this.elements.correctAnswerSelect.innerHTML = `
                        <option value="0">True</option>
                        <option value="1">False</option>
                    `;
                }
            },
            
            updateCorrectAnswerOptions() {
                this.elements.correctAnswerSelect.innerHTML = '';
                this.elements.mcqOptionInputs.forEach((input, index) => {
                    const text = input.value.trim() || `Option ${index + 1}`;
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = text;
                    this.elements.correctAnswerSelect.appendChild(option);
                });
            }
        };

                // Start the application
                App.init();

            // Hide congrats GIF when leaving quiz complete view
            function hideCongratsGif() {
                const congratsGif = document.getElementById('congrats-gif');
                if (congratsGif) {
                congratsGif.classList.add('hidden');
                }
            }

            // Listen for navigation away from quiz complete view
            document.getElementById('play-again-btn').addEventListener('click', hideCongratsGif);
            document.getElementById('back-to-menu-btn').addEventListener('click', hideCongratsGif);

                //custom added
                const music = document.getElementById("bg-music");
                const startBtn = document.getElementById("start-quiz-btn");
                startBtn.addEventListener("click", () => {
                        // Play music when quiz starts
                        music.play().catch(error => {
                                console.log("Autoplay blocked:", error);
                        });
                        // Optionally: hide the button after click
                        // startBtn.style.display = "none";
                });
</script>  
</body>
</html>




